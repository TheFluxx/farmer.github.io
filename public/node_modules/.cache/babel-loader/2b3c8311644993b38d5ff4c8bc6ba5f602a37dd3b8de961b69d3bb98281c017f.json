{"ast":null,"code":"import'./Task.css';import React,{useState}from'react';import{useDispatch,useSelector}from'react-redux';import{checkSubscriptionAndUpdateTask}from'../../store/slices/coinSlice';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";function Task(props){const{id,name,img,price,link,channel_id}=props;const[buttonText,setButtonText]=useState('Start');const[showModal,setShowModal]=useState(false);const[modalMessage,setModalMessage]=useState('');const[hasChecked,setHasChecked]=useState(false);const dispatch=useDispatch();const tasks_id_done=useSelector(state=>state.coin.tasks_id_done);const tg=window.Telegram.WebApp;const telegram_id=tg.initDataUnsafe.user.id;const handleStartClick=e=>{tg.HapticFeedback.notificationOccurred('success');e.preventDefault();window.Telegram.WebApp.openTelegramLink(link);setTimeout(()=>{setHasChecked(true);},1000);// задержка в 5 секунд перед отображением кнопки \"Check\"\n};const handleCheckClick=async()=>{tg.HapticFeedback.notificationOccurred('success');const result=await dispatch(checkSubscriptionAndUpdateTask({telegram_id,channel_id,task_id:id,price:price}));if(result.payload.isMember){setModalMessage(\"\\uD83C\\uDF89 Congratulations, you have earned: \".concat(price,\" $FARM coins!\"));}else{setModalMessage('😢 You have not subscribed 😢');}setShowModal(true);};const handleModalClose=()=>{setShowModal(false);};const isSubscribed=tasks_id_done.includes(id);return/*#__PURE__*/_jsxs(\"div\",{className:\"task\",children:[/*#__PURE__*/_jsx(\"img\",{src:img,alt:\"sprite\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"upgrade_autofarm task_mid\",children:[/*#__PURE__*/_jsx(\"h5\",{className:\"upgrade_header\",children:name}),/*#__PURE__*/_jsxs(\"div\",{className:\"upgrade_price_block\",children:[/*#__PURE__*/_jsx(\"img\",{src:\"./img/money-shop.png\",alt:\"money\"}),/*#__PURE__*/_jsx(\"p\",{className:\"upgrade_txt\",children:price})]})]}),!isSubscribed&&!hasChecked&&/*#__PURE__*/_jsx(\"button\",{className:\"buy_btn start_btn\",onClick:handleStartClick,children:/*#__PURE__*/_jsx(\"span\",{children:\"Start\"})}),!isSubscribed&&hasChecked&&/*#__PURE__*/_jsx(\"button\",{className:\"buy_btn check_btn\",onClick:handleCheckClick,children:/*#__PURE__*/_jsx(\"span\",{children:\"Check\"})}),isSubscribed&&/*#__PURE__*/_jsx(\"button\",{className:\"buy_btn done_btn\",children:/*#__PURE__*/_jsx(\"span\",{children:\"Done\"})})]});}export default Task;","map":{"version":3,"names":["React","useState","useDispatch","useSelector","checkSubscriptionAndUpdateTask","jsx","_jsx","jsxs","_jsxs","Task","props","id","name","img","price","link","channel_id","buttonText","setButtonText","showModal","setShowModal","modalMessage","setModalMessage","hasChecked","setHasChecked","dispatch","tasks_id_done","state","coin","tg","window","Telegram","WebApp","telegram_id","initDataUnsafe","user","handleStartClick","e","HapticFeedback","notificationOccurred","preventDefault","openTelegramLink","setTimeout","handleCheckClick","result","task_id","payload","isMember","concat","handleModalClose","isSubscribed","includes","className","children","src","alt","onClick"],"sources":["C:/Users/zheme/OneDrive/Desktop/git_domen/farmer.github.io/src/components/Task/Task.jsx"],"sourcesContent":["import './Task.css';\r\nimport React, { useState } from 'react';\r\nimport { useDispatch, useSelector } from 'react-redux';\r\nimport { checkSubscriptionAndUpdateTask } from '../../store/slices/coinSlice';\r\n\r\nfunction Task(props) {\r\n    const { id, name, img, price, link, channel_id } = props;\r\n    const [buttonText, setButtonText] = useState('Start');\r\n    const [showModal, setShowModal] = useState(false);\r\n    const [modalMessage, setModalMessage] = useState('');\r\n    const [hasChecked, setHasChecked] = useState(false);\r\n    const dispatch = useDispatch();\r\n    const tasks_id_done = useSelector((state) => state.coin.tasks_id_done);\r\n    const tg = window.Telegram.WebApp;\r\n    const telegram_id = tg.initDataUnsafe.user.id;\r\n\r\n    const handleStartClick = (e) => {\r\n        tg.HapticFeedback.notificationOccurred('success');\r\n        e.preventDefault();\r\n        window.Telegram.WebApp.openTelegramLink(link);\r\n        setTimeout(() => {\r\n            setHasChecked(true);\r\n        }, 1000); // задержка в 5 секунд перед отображением кнопки \"Check\"\r\n    };\r\n\r\n    const handleCheckClick = async () => {\r\n        tg.HapticFeedback.notificationOccurred('success');\r\n        const result = await dispatch(checkSubscriptionAndUpdateTask({ telegram_id, channel_id, task_id: id, price: price }));\r\n        if (result.payload.isMember) {\r\n            setModalMessage(`🎉 Congratulations, you have earned: ${price} $FARM coins!`);\r\n        } else {\r\n            setModalMessage('😢 You have not subscribed 😢');\r\n        }\r\n        setShowModal(true);\r\n    };\r\n\r\n    const handleModalClose = () => {\r\n        setShowModal(false);\r\n    };\r\n\r\n    const isSubscribed = tasks_id_done.includes(id);\r\n\r\n    return (\r\n        <div className=\"task\">\r\n            <img src={img} alt=\"sprite\" />\r\n            <div className=\"upgrade_autofarm task_mid\">\r\n                <h5 className=\"upgrade_header\">\r\n                    {name}\r\n                </h5>\r\n                <div className=\"upgrade_price_block\">\r\n                    <img src=\"./img/money-shop.png\" alt=\"money\" />\r\n                    <p className=\"upgrade_txt\">{price}</p>\r\n                </div>\r\n            </div>\r\n            {!isSubscribed && !hasChecked && (\r\n                <button className=\"buy_btn start_btn\" onClick={handleStartClick}>\r\n                    <span>Start</span>\r\n                </button>\r\n            )}\r\n            {!isSubscribed && hasChecked && (\r\n                <button className=\"buy_btn check_btn\" onClick={handleCheckClick}>\r\n                    <span>Check</span>\r\n                </button>\r\n            )}\r\n            {isSubscribed && (\r\n                <button className=\"buy_btn done_btn\">\r\n                    <span>Done</span>\r\n                </button>\r\n            )}\r\n\r\n            {/* {showModal && (\r\n                <div className=\"modal\">\r\n                    <div className=\"modal-content\">\r\n                        <span className=\"close\" onClick={handleModalClose}>&times;</span>\r\n                        <p>{modalMessage}</p>\r\n                    </div>\r\n                </div>\r\n            )} */}\r\n        </div>\r\n    );\r\n}\r\n\r\nexport default Task;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}